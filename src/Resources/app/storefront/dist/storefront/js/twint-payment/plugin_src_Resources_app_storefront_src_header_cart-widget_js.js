"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["plugin_src_Resources_app_storefront_src_header_cart-widget_js"],{401:(t,e,r)=>{r.r(e),r.d(e,{default:()=>g});var o=r(568),s=r(107);class i{static isSupported(){return"undefined"!==document.cookie}static setItem(t,e,r){if(null==t)throw Error("You must specify a key to set a cookie");let o=new Date;o.setTime(o.getTime()+864e5*r);let s="";"https:"===location.protocol&&(s="secure"),document.cookie="".concat(t,"=").concat(e,";expires=").concat(o.toUTCString(),";path=/;sameSite=lax;").concat(s)}static getItem(t){if(!t)return!1;let e=t+"=",r=document.cookie.split(";");for(let t=0;t<r.length;t++){let o=r[t];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(e))return o.substring(e.length,o.length)}return!1}static removeItem(t){document.cookie="".concat(t,"= ; expires = Thu, 01 Jan 1970 00:00:00 GMT;path=/")}static key(){return""}static clear(){}}class n{setItem(t,e){return this._storage[t]=e}getItem(t){return Object.prototype.hasOwnProperty.call(this._storage,t)?this._storage[t]:null}removeItem(t){return delete this._storage[t]}key(t){return Object.values(this._storage)[t]||null}clear(){return this._storage={}}constructor(){this._storage={}}}class a{_chooseStorage(){return a._isSupported(window.localStorage)?this._storage=window.localStorage:a._isSupported(window.sessionStorage)?this._storage=window.sessionStorage:i.isSupported()?this._storage=i:this._storage=new n}static _isSupported(t){try{let e="__storage_test";return t.setItem(e,"1"),t.removeItem(e),!0}catch(t){return!1}}_validateStorage(){if("function"!=typeof this._storage.setItem)throw Error('The storage must have a "setItem" function');if("function"!=typeof this._storage.getItem)throw Error('The storage must have a "getItem" function');if("function"!=typeof this._storage.removeItem)throw Error('The storage must have a "removeItem" function');if("function"!=typeof this._storage.key)throw Error('The storage must have a "key" function');if("function"!=typeof this._storage.clear)throw Error('The storage must have a "clear" function')}getStorage(){return this._storage}constructor(){this._storage=null,this._chooseStorage(),this._validateStorage()}}let c=Object.freeze(new a).getStorage();class h extends o.Z{init(){this._client=new s.Z,this.insertStoredContent(),this.fetch()}insertStoredContent(){c.setItem(this.options.emptyCartWidgetStorageKey,this.el.innerHTML);let t=c.getItem(this.options.cartWidgetStorageKey);t&&(this.el.innerHTML=t),this.$emitter.publish("insertStoredContent")}fetch(){this._client.get(window.router["frontend.checkout.info"],(t,e)=>{if(!(e.status>=500)){if(204===e.status){c.removeItem(this.options.cartWidgetStorageKey);let t=c.getItem(this.options.emptyCartWidgetStorageKey);t&&(this.el.innerHTML=t);return}c.setItem(this.options.cartWidgetStorageKey,t),this.el.innerHTML=t,this.$emitter.publish("fetch",{content:t})}})}}h.options={cartWidgetStorageKey:"cart-widget-template",emptyCartWidgetStorageKey:"empty-cart-widget"};class g extends h{insertStoredContent(){let t=this.el.innerHTML,e=t.match(/CHF.*\s*/g),r=e?e[0]:null;if(r){let e=r.replace(/\d/g,"0");t=t.replace(r,e)}c.setItem(this.options.emptyCartWidgetStorageKey,t);let o=c.getItem(this.options.cartWidgetStorageKey);o&&(this.el.innerHTML=o),this.$emitter.publish("insertStoredContent")}}}}]);