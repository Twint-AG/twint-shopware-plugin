!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=(window.__sw__.assetPath + '/bundles/twintpayment/'),r(r.s="I+oZ")}({"2Puq":function(e,t,r){var n=r("ncrE");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,r("P8hj").default)("0cbb2e34",n,!0,{})},"6D7V":function(e){e.exports=JSON.parse('{"twint":{"validation":{"errorTitle":"TWINT configuration error","errorMessage":"There was an error validating the TWINT certificate (selected file and password). Please try again or use a different certification."},"certificateErrorTitle":"Certificate","merchantErrorTitle":"Merchant ID","certificateSuccess":"Certificate is an valid TWINT certificate.","certificateLabel":"Certificate Password (optional)","certificateFileLabel":"Select a certificate file (.p12)","certificatePasswordHelpText":"The password for the certificate file is optional. If you have set a password for the certificate file, please enter it here.","errors":{"INVALID_CREDENTIAL":"Invalid credentials. Please check your certificate and password.","INVALID_TIME_RANGE":"Invalid time range","INVALID_ISSUER":"Invalid Issuer; Only allow CH and TWINT AG","invalidUUIDv4":"Invalid UUIDv4"}}}')},"I+oZ":function(e,t,r){"use strict";r.r(t);var n=r("fTAK"),i=r("6D7V");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(i=n.key,o=void 0,o=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===a(o)?o:String(o)),n)}var i,o}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var i=u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Shopware.Locale.extend("de-DE",n),Shopware.Locale.extend("en-GB",i);var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(a,e);var t,r,n,i=s(a);function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"twint";return o(this,a),i.call(this,e,t,r)}return t=a,(r=[{key:"uploadFile",value:function(e,t){var r=this.getBasicHeaders();r["Content-Type"]="multipart/form-data";var n=new FormData;return n.append("file",e),n.append("password",t),this.httpClient.post("_actions/twint/extract-pem",n,{headers:r})}}])&&c(t.prototype,r),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Shopware.Classes.ApiService);Shopware.Application.addServiceProvider("twintFileUploadService",(function(){return new d(Shopware.Application.getContainer("init").httpClient,Shopware.Service("loginService"))}));r("2Puq");var p=Shopware,v=p.Component,h=p.Mixin;v.register("twint-certificate",{template:Shopware.Feature.isActive("v6.6.0.0")?'{% block twint_certificate_block %}\n    <div>\n        <sw-file-input\n            v-model="currentCertFile"\n            :allowed-mime-types="[\'application/x-pkcs12\']"\n            :maxFileSize="8*1024*1024"\n            @update:value="onFileChange"\n            required\n        >\n            <template #caption-label>\n                {{ $tc(\'twint.certificateFileLabel\') }}\n            </template>\n        </sw-file-input>\n\n        <sw-password-field\n                v-model:value="currentPassword"\n                :entity-collection="null"\n                class="twint-config-field"\n                :label="$tc(\'twint.certificateLabel\')"\n                :help-text="$tc(\'twint.certificatePasswordHelpText\')"\n                @blur="updatePassword">\n            <template #suffix>\n                {% block twint_certificate_password_suffix_block %}\n                    <sw-icon name="regular-low-vision" size="22px"></sw-icon>\n                {% endblock %}\n            </template>\n        </sw-password-field>\n    </div>\n{% endblock %}\n':'{% block twint_certificate_block %}\n    <div>\n        <sw-file-input\n            v-model="currentCertFile"\n            :allowed-mime-types="[\'application/x-pkcs12\']"\n            :maxFileSize="8*1024*1024"\n            @change="onFileChange"\n            required\n        >\n            <template #caption-label>\n                {{ $tc(\'twint.certificateFileLabel\') }}\n            </template>\n        </sw-file-input>\n\n        <sw-password-field\n                v-model:value="currentPassword"\n                :entity-collection="null"\n                class="twint-config-field"\n                :label="$tc(\'twint.certificateLabel\')"\n                :help-text="$tc(\'twint.certificatePasswordHelpText\')"\n                @blur="updatePassword">\n            <template #suffix>\n                {% block twint_certificate_password_suffix_block %}\n                    <sw-icon name="regular-low-vision" size="22px"></sw-icon>\n                {% endblock %}\n            </template>\n        </sw-password-field>\n    </div>\n{% endblock %}\n',mixins:[h.getByName("notification")],inject:["feature"],data:function(){return{currentPassword:null,currentCertFile:null}},methods:{onFileChange:function(e){this.currentCertFile=e,this.extractPem()},updatePassword:function(e){this.extractPem()},extractPem:function(){var e,t=this,r=Shopware.Service("twintFileUploadService");this.currentCertFile&&r.uploadFile(this.currentCertFile,null!==(e=this.currentPassword)&&void 0!==e?e:"").then((function(e){t.updateCertificate(e.data.data),t.createNotification({title:"Success",message:t.$tc("twint.certificateSuccess"),growl:!0}).then((function(e){}))})).catch((function(e){if(400===e.response.status){var r=e.response.data.errorCode;return t.createNotificationError({title:t.$tc("twint.certificateErrorTitle"),message:t.$tc("twint.errors."+r),growl:!0})}t.createNotificationError({title:t.$tc("twint.certificateErrorTitle"),message:t.$tc("twint.validation.errorMessage"),growl:!0})}))},updateCertificate:function(e){this.feature.isActive("v6.6.0.0")?this.$emit("update:value",e):this.$emit("input",e)}}});r("pfrm")},P8hj:function(e,t,r){"use strict";function n(e,t){for(var r=[],n={},i=0;i<t.length;i++){var a=t[i],o=a[0],c={id:e+":"+i,css:a[1],media:a[2],sourceMap:a[3]};n[o]?n[o].parts.push(c):r.push(n[o]={id:o,parts:[c]})}return r}r.r(t),r.d(t,"default",(function(){return v}));var i="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var a={},o=i&&(document.head||document.getElementsByTagName("head")[0]),c=null,l=0,s=!1,f=function(){},u=null,d="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(e,t,r,i){s=r,u=i||{};var o=n(e,t);return h(o),function(t){for(var r=[],i=0;i<o.length;i++){var c=o[i];(l=a[c.id]).refs--,r.push(l)}t?h(o=n(e,t)):o=[];for(i=0;i<r.length;i++){var l;if(0===(l=r[i]).refs){for(var s=0;s<l.parts.length;s++)l.parts[s]();delete a[l.id]}}}}function h(e){for(var t=0;t<e.length;t++){var r=e[t],n=a[r.id];if(n){n.refs++;for(var i=0;i<n.parts.length;i++)n.parts[i](r.parts[i]);for(;i<r.parts.length;i++)n.parts.push(m(r.parts[i]));n.parts.length>r.parts.length&&(n.parts.length=r.parts.length)}else{var o=[];for(i=0;i<r.parts.length;i++)o.push(m(r.parts[i]));a[r.id]={id:r.id,refs:1,parts:o}}}}function w(){var e=document.createElement("style");return e.type="text/css",o.appendChild(e),e}function m(e){var t,r,n=document.querySelector("style["+d+'~="'+e.id+'"]');if(n){if(s)return f;n.parentNode.removeChild(n)}if(p){var i=l++;n=c||(c=w()),t=g.bind(null,n,i,!1),r=g.bind(null,n,i,!0)}else n=w(),t=S.bind(null,n),r=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else r()}}var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function g(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=y(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function S(e,t){var r=t.css,n=t.media,i=t.sourceMap;if(n&&e.setAttribute("media",n),u.ssrId&&e.setAttribute(d,t.id),i&&(r+="\n/*# sourceURL="+i.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}},fTAK:function(e){e.exports=JSON.parse('{"twint":{"validation":{"errorTitle":"TWINT payment validation error","errorMessage":"There was an error validating the TWINT certificate (selected file and password). Please try again or use a different certification."},"certificateSuccess":"Certificate is an valid TWINT certificate.","certificateErrorTitle":"Certificate","merchantErrorTitle":"Merchant ID","certificateLabel":"Certificate Password (optional)","certificatePasswordHelpText":"The password for the certificate file is optional. If you have set a password for the certificate file, please enter it here.","certificateFileLabel":"Select a certificate file (.p12)","errors":{"INVALID_CREDENTIAL":"Invalid credentials. Please check your certificate and password.","INVALID_TIME_RANGE":"Invalid time range","INVALID_ISSUER":"Invalid Issuer; Only allow CH and TWINT AG"}}}')},ncrE:function(e,t,r){},pfrm:function(e,t){var r=Shopware,n=r.Component,i=r.Mixin;n.extend("twint-merchant-id","sw-text-field",{mixins:[i.getByName("notification")],methods:{onChange:function(e){this.$super("onChange",e),this.isValidUUIDv4(e.target.value)||this.createNotificationError({title:this.$tc("twint.merchantErrorTitle"),message:this.$tc("twint.errors.invalidUUIDv4")})},isValidUUIDv4:function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}}})}});
//# sourceMappingURL=twint-payment.js.map